{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./App.css';import Message from'./Components/Message';import Sender from'./Components/Sender';import{Route,Routes}from'react-router-dom';import{createClient}from'@supabase/supabase-js';import Chat from'./pages/Chat.jsx';import Home from'./pages/Home.jsx';import Controls from'./pages/Control.jsx';import Vote from'./pages/Vote.jsx';import Board from'./pages/Board.jsx';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const supabaseUrl=\"https://jftaxymlbutkjoacvtbk.supabase.co\";const supabaseKey=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmdGF4eW1sYnV0a2pvYWN2dGJrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTM5NjkxOTMsImV4cCI6MjAyOTU0NTE5M30.2aT1UzmiN34aKLNRUXAKwhKfnuwxMoiM3eMkHs1oyZU\";const supabase=createClient(supabaseUrl,supabaseKey);function App(){const[user,setUser]=useState(null);async function getURL(){const{data,error}=await supabase.from(\"controller\").select('currentURL').limit(1);const url=data[0].currentURL;console.log(\"URL: \"+window.location.href);console.log(\"Supabase: \"+url);if(url!==\"\"&&url!==null&&!user){if(url!==window.location.href){if(!window.location.pathname.toLowerCase().includes(\"controls\")){if(!window.location.pathname.toLowerCase().includes(\"board\")){window.location.href=url;}}}}}getURL();async function getUser(){try{const{data,error}=await supabase.auth.getUser();if(error){setUser(null);console.log(\"No user\");throw error;}if(data.user){setUser(data.user);console.log(data.user);}else{setUser(null);console.log(\"No user\");}if(document.getElementById('signinform')){document.getElementById('signinform').style.display='none';document.getElementById('signout').style.display='flex';}}catch(error){console.error('Error fetching user:',error.message);}}useEffect(()=>{getUser();},[]);// Run only on component mount\nuseEffect(()=>{const urlchanges=supabase.channel('schema-db-changes').on('postgres_changes',{event:'*',schema:'public'},payload=>{const url=payload.new.currentURL;console.log(\"URL: \"+window.location.href);if(url!==\"\"&&url!==null){if(url!==window.location.href){if(!window.location.pathname.toLowerCase().includes(\"controls\")){if(!window.location.pathname.toLowerCase().includes(\"board\")){console.log(\"URL: \"+url);window.location.href=url;}}}}}).subscribe();});useEffect(()=>{if(!user){// REALTIME LISTENERS\nconst channelA=supabase.channel('show');function messageReceived(payload){alert(\"Got it\");console.log(payload);const url=payload.payload.url;if(url!==window.location.href){window.location.href=url;}}}},[user]);// Run whenever user changes\nreturn/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/chat\",element:/*#__PURE__*/_jsx(Chat,{})}),/*#__PURE__*/_jsx(Route,{path:\"/controls\",element:/*#__PURE__*/_jsx(Controls,{})}),/*#__PURE__*/_jsx(Route,{path:\"/vote\",element:/*#__PURE__*/_jsx(Vote,{})}),/*#__PURE__*/_jsx(Route,{path:\"/board\",element:/*#__PURE__*/_jsx(Board,{})})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","Message","Sender","Route","Routes","createClient","Chat","Home","Controls","Vote","Board","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","supabaseUrl","supabaseKey","supabase","App","user","setUser","getURL","data","error","from","select","limit","url","currentURL","console","log","window","location","href","pathname","toLowerCase","includes","getUser","auth","document","getElementById","style","display","message","urlchanges","channel","on","event","schema","payload","new","subscribe","channelA","messageReceived","alert","children","path","element"],"sources":["C:/Users/mdalb/Desktop/dramainteractive/dramainteractive/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './App.css';\nimport Message from './Components/Message';\nimport Sender from './Components/Sender';\nimport { Route, Routes } from 'react-router-dom';\n\nimport { createClient } from '@supabase/supabase-js';\nimport Chat from './pages/Chat.jsx';\nimport Home from './pages/Home.jsx';\nimport Controls from './pages/Control.jsx';\nimport Vote from './pages/Vote.jsx';\nimport Board from './pages/Board.jsx';\n\nconst supabaseUrl = \"https://jftaxymlbutkjoacvtbk.supabase.co\";\nconst supabaseKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmdGF4eW1sYnV0a2pvYWN2dGJrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTM5NjkxOTMsImV4cCI6MjAyOTU0NTE5M30.2aT1UzmiN34aKLNRUXAKwhKfnuwxMoiM3eMkHs1oyZU\";\nconst supabase = createClient(supabaseUrl, supabaseKey);\n\nfunction App() {\n  const [user, setUser] = useState(null);\n\n\n  async function getURL() {\n    const { data, error } = await supabase\n      .from(\"controller\")\n      .select('currentURL')\n      .limit(1)\n    const url = data[0].currentURL\n    console.log(\"URL: \" + window.location.href)\n    console.log(\"Supabase: \" + url)\n    if (url !== \"\" && url !== null && !user) {\n      if (url !== window.location.href) {\n        if (!window.location.pathname.toLowerCase().includes(\"controls\")) {\n          if (!window.location.pathname.toLowerCase().includes(\"board\")) {\n            window.location.href = url\n          }\n        }\n      }\n    }\n\n  }\n  getURL()\n\n  async function getUser() {\n    try {\n      const { data, error } = await supabase.auth.getUser();\n      if (error) {\n        setUser(null);\n        console.log(\"No user\");\n        throw error;\n      }\n      if (data.user) {\n        setUser(data.user);\n        console.log(data.user);\n      } else {\n        setUser(null);\n        console.log(\"No user\");\n      }\n      if (document.getElementById('signinform')) {\n        document.getElementById('signinform').style.display = 'none';\n        document.getElementById('signout').style.display = 'flex';\n      }\n    } catch (error) {\n      console.error('Error fetching user:', error.message);\n    }\n  }\n\n  useEffect(() => {\n    getUser();\n  }, []); // Run only on component mount\n\n  useEffect(() => {\n\n    const urlchanges = supabase\n      .channel('schema-db-changes')\n      .on(\n        'postgres_changes',\n        {\n          event: '*',\n          schema: 'public',\n        },\n        (payload) => {\n          const url = payload.new.currentURL\n          console.log(\"URL: \" + window.location.href)\n          if (url !== \"\" && url !== null) {\n            if (url !== window.location.href) {\n              if (!window.location.pathname.toLowerCase().includes(\"controls\")) {\n                if (!window.location.pathname.toLowerCase().includes(\"board\")) {\n                  console.log(\"URL: \" + url)\n                  window.location.href = url\n                }\n              }\n            }\n          }\n        }\n      )\n      .subscribe()\n  })\n\n  useEffect(() => {\n    if (!user) {\n      // REALTIME LISTENERS\n      const channelA = supabase.channel('show');\n\n      function messageReceived(payload) {\n        alert(\"Got it\");\n        console.log(payload);\n        const url = payload.payload.url;\n        if (url !== window.location.href) {\n          window.location.href = url\n        }\n      }\n\n\n    }\n  }, [user]); // Run whenever user changes\n\n  return (\n    <>\n      <Routes>\n        <Route path=\"/\" element={<Home />} />\n        <Route path=\"/chat\" element={<Chat />} />\n        <Route path=\"/controls\" element={<Controls />} />\n        <Route path=\"/vote\" element={<Vote />} />\n        <Route path=\"/board\" element={<Board />} />\n      </Routes>\n    </>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}