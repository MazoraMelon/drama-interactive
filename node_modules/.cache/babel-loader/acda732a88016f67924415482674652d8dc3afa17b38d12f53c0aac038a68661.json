{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./App.css';import Message from'./Components/Message';import Sender from'./Components/Sender';import{Route,Routes}from'react-router-dom';import{createClient}from'@supabase/supabase-js';import Chat from'./pages/Chat.jsx';import Home from'./pages/Home.jsx';import Controls from'./pages/Control.jsx';import Vote from'./pages/Vote.jsx';import Board from'./pages/Board.jsx';import Running from'./pages/Running.jsx';import Waiting from'./pages/Waiting.jsx';import Lost from'./pages/Lost.jsx';import Story from'./pages/Story.jsx';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const supabaseUrl=\"https://jftaxymlbutkjoacvtbk.supabase.co\";const supabaseKey=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmdGF4eW1sYnV0a2pvYWN2dGJrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTM5NjkxOTMsImV4cCI6MjAyOTU0NTE5M30.2aT1UzmiN34aKLNRUXAKwhKfnuwxMoiM3eMkHs1oyZU\";const supabase=createClient(supabaseUrl,supabaseKey);function App(){const[user,setUser]=useState(null);async function getURL(){const{data,error}=await supabase.from(\"controller\").select('currentURL').limit(1);const newurl=data[0].currentURL;console.log(\"Current url: \"+window.location.href);console.log(\"Supabase given url: \"+newurl);if(newurl!==\"\"&&newurl!==null&&!user){if(newurl!==window.location.href){if(!window.location.pathname.toLowerCase().includes(\"controls\")&&!window.location.hash.toLowerCase().includes(\"controls\")){if(!window.location.pathname.toLowerCase().includes(\"board\")&&!window.location.hash.toLowerCase().includes(\"board\")){if(!window.location.href.toLowerCase().includes(\"waiting\")){console.log(\"Changing to: \"+newurl);window.location.href=newurl;}}}}}}getURL();async function getUser(){try{const{data,error}=await supabase.auth.getUser();if(error){setUser(null);console.log(\"No user\");throw error;}if(data.user){setUser(data.user);console.log(data.user);}else{setUser(null);console.log(\"No user\");}if(document.getElementById('signinform')){document.getElementById('signinform').style.display='none';document.getElementById('signout').style.display='flex';}}catch(error){console.error('Error fetching user:',error.message);}}useEffect(()=>{getUser();},[]);// Run only on component mount\nuseEffect(()=>{const urlchanges=supabase.channel('schema-db-changes').on('postgres_changes',{event:'UPDATE',schema:'public'},payload=>{const newurl=payload.new.currentURL;console.log(\"Current url: \"+window.location.href);console.log(\"Supabase given url: \"+newurl);if(newurl!==\"\"&&newurl!==null&&!user){if(newurl!==window.location.href){if(!window.location.pathname.toLowerCase().includes(\"controls\")&&!window.location.hash.toLowerCase().includes(\"controls\")){if(!window.location.pathname.toLowerCase().includes(\"board\")&&!window.location.hash.toLowerCase().includes(\"board\")){if(!window.location.href.toLowerCase().includes(\"waiting\")){console.log(\"Changing to: \"+newurl);window.location.href=newurl;}}}}}}).subscribe();});useEffect(()=>{if(!user){// REALTIME LISTENERS\nconst channelA=supabase.channel('show');function messageReceived(payload){console.log(payload);const url=payload.payload.url;if(url!==window.location.href){window.location.href=url;}}}},[user]);// Run whenever user changes\nreturn/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/waiting\",element:/*#__PURE__*/_jsx(Waiting,{})}),/*#__PURE__*/_jsx(Route,{path:\"/chat\",element:/*#__PURE__*/_jsx(Chat,{})}),/*#__PURE__*/_jsx(Route,{path:\"/controls\",element:/*#__PURE__*/_jsx(Controls,{})}),/*#__PURE__*/_jsx(Route,{path:\"/vote\",element:/*#__PURE__*/_jsx(Vote,{})}),/*#__PURE__*/_jsx(Route,{path:\"/board\",element:/*#__PURE__*/_jsx(Board,{})}),/*#__PURE__*/_jsx(Route,{path:\"/running\",element:/*#__PURE__*/_jsx(Running,{})}),/*#__PURE__*/_jsx(Route,{path:\"/lost\",element:/*#__PURE__*/_jsx(Lost,{})}),/*#__PURE__*/_jsx(Route,{path:\"/story/:name\",element:/*#__PURE__*/_jsx(Story,{})})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","Message","Sender","Route","Routes","createClient","Chat","Home","Controls","Vote","Board","Running","Waiting","Lost","Story","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","supabaseUrl","supabaseKey","supabase","App","user","setUser","getURL","data","error","from","select","limit","newurl","currentURL","console","log","window","location","href","pathname","toLowerCase","includes","hash","getUser","auth","document","getElementById","style","display","message","urlchanges","channel","on","event","schema","payload","new","subscribe","channelA","messageReceived","url","children","path","element"],"sources":["C:/Users/mdalb/Desktop/dramainteractive/dramainteractive/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './App.css';\r\nimport Message from './Components/Message';\r\nimport Sender from './Components/Sender';\r\nimport { Route, Routes } from 'react-router-dom';\r\n\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport Chat from './pages/Chat.jsx';\r\nimport Home from './pages/Home.jsx';\r\nimport Controls from './pages/Control.jsx';\r\nimport Vote from './pages/Vote.jsx';\r\nimport Board from './pages/Board.jsx';\r\nimport Running from './pages/Running.jsx';\r\nimport Waiting from './pages/Waiting.jsx';\r\nimport Lost from './pages/Lost.jsx';\r\nimport Story from './pages/Story.jsx';\r\n\r\nconst supabaseUrl = \"https://jftaxymlbutkjoacvtbk.supabase.co\";\r\nconst supabaseKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmdGF4eW1sYnV0a2pvYWN2dGJrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTM5NjkxOTMsImV4cCI6MjAyOTU0NTE5M30.2aT1UzmiN34aKLNRUXAKwhKfnuwxMoiM3eMkHs1oyZU\";\r\nconst supabase = createClient(supabaseUrl, supabaseKey);\r\n\r\nfunction App() {\r\n  const [user, setUser] = useState(null);\r\n\r\n\r\n  async function getURL() {\r\n    const { data, error } = await supabase\r\n      .from(\"controller\")\r\n      .select('currentURL')\r\n      .limit(1)\r\n    const newurl = data[0].currentURL\r\n    console.log(\"Current url: \" + window.location.href)\r\n    console.log(\"Supabase given url: \" + newurl)\r\n    if (newurl !== \"\" && newurl !== null && !user) {\r\n      if (newurl !== window.location.href) {\r\n        if (!window.location.pathname.toLowerCase().includes(\"controls\") && !window.location.hash.toLowerCase().includes(\"controls\")) {\r\n          if (!window.location.pathname.toLowerCase().includes(\"board\") && !window.location.hash.toLowerCase().includes(\"board\")) {\r\n            if (!window.location.href.toLowerCase().includes(\"waiting\")) {\r\n              console.log(\"Changing to: \" + newurl)\r\n              window.location.href = newurl\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n  getURL()\r\n\r\n  async function getUser() {\r\n    try {\r\n      const { data, error } = await supabase.auth.getUser();\r\n      if (error) {\r\n        setUser(null);\r\n        console.log(\"No user\");\r\n        throw error;\r\n      }\r\n      if (data.user) {\r\n        setUser(data.user);\r\n        console.log(data.user);\r\n      } else {\r\n        setUser(null);\r\n        console.log(\"No user\");\r\n      }\r\n      if (document.getElementById('signinform')) {\r\n        document.getElementById('signinform').style.display = 'none';\r\n        document.getElementById('signout').style.display = 'flex';\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching user:', error.message);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    getUser();\r\n  }, []); // Run only on component mount\r\n\r\n  useEffect(() => {\r\n\r\n    const urlchanges = supabase\r\n      .channel('schema-db-changes')\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: 'UPDATE',\r\n          schema: 'public',\r\n        },\r\n        (payload) => {\r\n          const newurl = payload.new.currentURL\r\n          console.log(\"Current url: \" + window.location.href)\r\n          console.log(\"Supabase given url: \" + newurl)\r\n          if (newurl !== \"\" && newurl !== null && !user) {\r\n            if (newurl !== window.location.href) {\r\n              if (!window.location.pathname.toLowerCase().includes(\"controls\") && !window.location.hash.toLowerCase().includes(\"controls\")) {\r\n                if (!window.location.pathname.toLowerCase().includes(\"board\") && !window.location.hash.toLowerCase().includes(\"board\")) {\r\n                  if (!window.location.href.toLowerCase().includes(\"waiting\")) {\r\n                    console.log(\"Changing to: \" + newurl)\r\n                    window.location.href = newurl\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n      )\r\n      .subscribe()\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      // REALTIME LISTENERS\r\n      const channelA = supabase.channel('show');\r\n\r\n      function messageReceived(payload) {\r\n\r\n        console.log(payload);\r\n        const url = payload.payload.url;\r\n        if (url !== window.location.href) {\r\n          window.location.href = url\r\n        }\r\n      }\r\n\r\n\r\n    }\r\n  }, [user]); // Run whenever user changes\r\n\r\n  return (\r\n    <>\r\n      <Routes>\r\n        <Route path=\"/\" element={<Home />} />\r\n        <Route path=\"/waiting\" element={<Waiting />} />\r\n        <Route path=\"/chat\" element={<Chat />} />\r\n        <Route path=\"/controls\" element={<Controls />} />\r\n        <Route path=\"/vote\" element={<Vote />} />\r\n        <Route path=\"/board\" element={<Board />} />\r\n        <Route path=\"/running\" element={<Running />} />\r\n        <Route path=\"/lost\" element={<Lost />} />\r\n        <Route path=\"/story/:name\" element={<Story />} />\r\n      </Routes>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}