{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import\"../App.css\";import Message from'../Components/Message';import Sender from'../Components/Sender';import{Route,Routes}from'react-router-dom';import{createClient}from'@supabase/supabase-js';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const supabaseUrl=\"https://jftaxymlbutkjoacvtbk.supabase.co\";const supabaseKey=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmdGF4eW1sYnV0a2pvYWN2dGJrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTM5NjkxOTMsImV4cCI6MjAyOTU0NTE5M30.2aT1UzmiN34aKLNRUXAKwhKfnuwxMoiM3eMkHs1oyZU\";const supabase=createClient(supabaseUrl,supabaseKey);function Chat(){const[username,setUsername]=useState(localStorage.getItem('username')||null);const[messages,setMessages]=useState([]);const[audienceChat,setAudienceChat]=useState(false);useEffect(()=>{// Function to set the username\nasync function setUserName(){const storedUsername=localStorage.getItem('username');if(!storedUsername||storedUsername==='Anonymous'||storedUsername===null){const enteredUsername=prompt('Enter a username');if(enteredUsername){localStorage.setItem('username',enteredUsername);setUsername(enteredUsername);}}}setUserName();},[]);useEffect(()=>{// Subscribe to real-time inserts\nconst channels=supabase.channel('custom-inserts').on('postgres_changes',{event:'INSERT',schema:'public',table:'messages'},payload=>{const newMessage={message:payload.new.message,sender:payload.new.sender,owner:payload.new.sender===username};setMessages(prevMessages=>[...prevMessages,newMessage]);}).subscribe();return()=>{// Unsubscribe from channels when component unmounts\nchannels.unsubscribe();};},[username]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{style:{color:'grey',fontSize:'1.5rem',margin:'5px',cursor:'pointer'},onClick:()=>{const newUsername=prompt('Enter a new username',username);if(newUsername){localStorage.setItem('username',newUsername);setUsername(newUsername);}},children:username}),/*#__PURE__*/_jsx(\"div\",{className:\"Chat\",style:{display:\"flex\",flexDirection:\"column\",alignItems:'flex-start',justifyContent:'flex-start'},children:messages.map((msg,index)=>/*#__PURE__*/_jsx(Message,{message:msg.message,sender:msg.sender,owner:msg.sender===username},index))}),/*#__PURE__*/_jsx(Sender,{username:username,canChat:audienceChat})]});}export default Chat;","map":{"version":3,"names":["React","useEffect","useState","Message","Sender","Route","Routes","createClient","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","supabaseUrl","supabaseKey","supabase","Chat","username","setUsername","localStorage","getItem","messages","setMessages","audienceChat","setAudienceChat","setUserName","storedUsername","enteredUsername","prompt","setItem","channels","channel","on","event","schema","table","payload","newMessage","message","new","sender","owner","prevMessages","subscribe","unsubscribe","children","style","color","fontSize","margin","cursor","onClick","newUsername","className","display","flexDirection","alignItems","justifyContent","map","msg","index","canChat"],"sources":["C:/Users/mdalb/Desktop/dramainteractive/dramainteractive/src/pages/Chat.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport \"../App.css\";\r\nimport Message from '../Components/Message';\r\nimport Sender from '../Components/Sender';\r\nimport { Route, Routes } from 'react-router-dom';\r\nimport { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = \"https://jftaxymlbutkjoacvtbk.supabase.co\";\r\nconst supabaseKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmdGF4eW1sYnV0a2pvYWN2dGJrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTM5NjkxOTMsImV4cCI6MjAyOTU0NTE5M30.2aT1UzmiN34aKLNRUXAKwhKfnuwxMoiM3eMkHs1oyZU\";\r\nconst supabase = createClient(supabaseUrl, supabaseKey);\r\n\r\nfunction Chat() {\r\n    const [username, setUsername] = useState(localStorage.getItem('username') || null);\r\n    const [messages, setMessages] = useState([]);\r\n    const [audienceChat, setAudienceChat] = useState(false);\r\n\r\n    useEffect(() => {\r\n        // Function to set the username\r\n        async function setUserName() {\r\n            const storedUsername = localStorage.getItem('username');\r\n            if (!storedUsername || storedUsername === 'Anonymous' || storedUsername === null) {\r\n                const enteredUsername = prompt('Enter a username');\r\n                if (enteredUsername) {\r\n                    localStorage.setItem('username', enteredUsername);\r\n                    setUsername(enteredUsername);\r\n                }\r\n            }\r\n        }\r\n        setUserName();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        // Subscribe to real-time inserts\r\n        const channels = supabase.channel('custom-inserts')\r\n            .on(\r\n                'postgres_changes',\r\n                { event: 'INSERT', schema: 'public', table: 'messages' },\r\n                (payload) => {\r\n                    const newMessage = {\r\n                        message: payload.new.message,\r\n                        sender: payload.new.sender,\r\n                        owner: payload.new.sender === username\r\n                    };\r\n                    setMessages(prevMessages => [...prevMessages, newMessage]);\r\n                }\r\n            )\r\n            .subscribe();\r\n\r\n\r\n\r\n\r\n\r\n        return () => {\r\n            // Unsubscribe from channels when component unmounts\r\n            channels.unsubscribe();\r\n        };\r\n    }, [username]);\r\n\r\n    return (\r\n        <>\r\n            <h1\r\n                style={{\r\n                    color: 'grey',\r\n                    fontSize: '1.5rem',\r\n                    margin: '5px',\r\n                    cursor: 'pointer'\r\n                }}\r\n                onClick={() => {\r\n                    const newUsername = prompt('Enter a new username', username);\r\n                    if (newUsername) {\r\n                        localStorage.setItem('username', newUsername);\r\n                        setUsername(newUsername);\r\n                    }\r\n                }}\r\n            >\r\n                {username}\r\n            </h1>\r\n            <div className=\"Chat\" style={{\r\n                display: \"flex\",\r\n                flexDirection: \"column\",\r\n                alignItems: 'flex-start',\r\n                justifyContent: 'flex-start',\r\n            }}>\r\n                {messages.map((msg, index) => (\r\n                    <Message\r\n                        key={index}\r\n                        message={msg.message}\r\n                        sender={msg.sender}\r\n                        owner={msg.sender === username}\r\n                    />\r\n                ))}\r\n            </div>\r\n            <Sender username={username} canChat={audienceChat} />\r\n        </>\r\n    );\r\n}\r\n\r\nexport default Chat;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}